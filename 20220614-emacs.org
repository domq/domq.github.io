#+TITLE: Emacs en partant de zÃ©ro
#+SUBTITLE: https://go.epfl.ch/emacsdezero
#+DATE: 14.06.2022
#+AUTHOR: Dominique Quatravaux
#+EMAIL: dominique@quatravaux.org
#+LANGUAGE: fr
#+OPTIONS: timestamp:nil
#+OPTIONS: toc:1
#+OPTIONS: num:nil
#+MACRO: vocabulaire *ğŸ“š Vocabulaire*
#+MACRO: definitionofdone *ğŸ¯ /Definition of done/*
#+MACRO: flecheverslebas @@html:<span style="font: 3em bold; display: inline-block; color: var(--r-link-color);">Ë…</span>@@
#+MACRO: lettrine @@html:<span style="display: inline; vertical-align: 0%; font-size: 2em">$1</span>@@
#+REVEAL_ROOT: https://cdn.jsdelivr.net/npm/reveal.js@4.3.1/
#+REVEAL_HLEVEL: 2
#+REVEAL_HEAD_PREAMBLE: <style type="text/css">
#+REVEAL_HEAD_PREAMBLE:  .reveal ul { display: inherit; }
#+REVEAL_HEAD_PREAMBLE:  section.slide-text-white { color: white; }
#+REVEAL_HEAD_PREAMBLE:  p.small { font-size: 0.6em; text-align: justify; }
#+REVEAL_HEAD_PREAMBLE:  code {  color: lightblue; }
#+REVEAL_HEAD_PREAMBLE: </style>
#+REVEAL_TITLE_SLIDE_BACKGROUND: https://media.mehrnews.com/d/2019/07/21/4/3185382.jpg
#+REVEAL_TITLE_SLIDE_BACKGROUND_OPACITY: 0.3

* Chapitre 1 : autonomie
** Philosophie / orientation
    :PROPERTIES:
    :reveal_background: https://img.static-rmg.be/a/view/q75/w962/h503/4264804/4c49c975418611b921b55576f621e8ae-jpg.jpg
    :reveal_background_opacity: 0.4
    :html_container_class: slide-text-white
    :END:
- Ne pas s'attendre Ã  ce que Ã§a Juste Marcheâ„¢ ! #desfoisoui #desfoisnon
- Un Ã©cosystÃ¨me prolifÃ©rant â€” Pas facile de faire les bons choix
- MÃªme choisir une direction pour avancer peut faire l'objet d'un [[https://github.com/redguardtoo/mastering-emacs-in-one-year-guide][tuto]] !
  - ğŸ’ S'astreindre Ã  une {{{definitionofdone}}}
  - ConcrÃ¨tement : un jeu de tests manuel (rÃ©digÃ© et observÃ©)

** But #1 : installation
- Pour le prÃ©sent dojo : version minimale = Emacs 26 (celui d'Ubuntu Focal), mais plus rÃ©cent â‰¡ mieux

@@html:<p class="small">@@{{{lettrine(ğŸ’¡ğŸ¥±)}}}
Si vous vous ennuyez : cliquez sur {{{flecheverslebas}}} en bas Ã  droite...
@@html:</p>@@

*** Ã€ propos de cette prÃ©sentation
    :PROPERTIES:
    :reveal_background: https://w0.peakpx.com/wallpaper/178/808/HD-wallpaper-heavenly-trumpets-statues-music-trumpet-heaven-celestial-angels.jpg
    :reveal_background_opacity: 0.3
    :html_container_class: slide-text-white
    :END:

- Ã‰crite Ã  100% dans Emacs
- Un seul [[https://github.com/domq/domq.github.io/blob/main/20220614-emacs.org][fichier source]]
- ğŸ”‹ GrÃ¢ce Ã  [[https://orgmode.org/][ğŸ¦„ org-mode]] + [[https://github.com/hexmode/ox-reveal][org-reveal]]

@@html:<p class="small">@@{{{lettrine(â†•ï¸)}}}
Comme dans toute prÃ©sentation [[https://revealjs.com/][reveal.js]], la flÃ¨che vers le bas {{{flecheverslebas}}} permet de naviguer vers des informations supplÃ©mentaires, que le prÃ©sentateur Â«sauteraÂ» peut-Ãªtre faute de temps.
@@html:</p>@@

*** Balises
    :PROPERTIES:
    :reveal_background: https://upload.wikimedia.org/wikipedia/commons/thumb/0/0b/BhfEpfenhofen_Ausfahrsignale_Talaufwaerts_II.JPG/1200px-BhfEpfenhofen_Ausfahrsignale_Talaufwaerts_II.JPG
    :reveal_background_opacity: 0.3
    :html_container_class: slide-text-white
    :END:

- {{{vocabulaire}}} :: Cette annotation repÃ¨re les mots et concepts qu'utilise Emacs dans un sens bien Ã  lui (privilÃ¨ge de l'Ã¢ge...)
- {{{definitionofdone}}} :: Cette annotation suggÃ¨re un nouveau point d'attention dans votre /definition of done/ ou contrÃ´le-qualitÃ© de votre configuration Emacs. ConsidÃ©rez que vous venez de gagner un level lorsque vous la rencontrez ğŸ˜‰

** But #2 : Ã©diter un fichier
- Ouvrir un fichier
  - Ã€ la souris, via les menus
  - Au clavier
    - ğŸ’¡ Les menus montrent les raccourcis clavier !
    - Suivez le guide : [[https://www.gnu.org/software/emacs/refcards/pdf/refcard.pdf][GNU Emacs Reference Card]]
- Visualiser l'Ã©tat sauvegardÃ© ou non
  - {{{vocabulaire}}} : modeline
- Sauvegarder

** But #3 : plusieurs fichiers Ã  la fois

- {{{vocabulaire}}} : buffer
- Exercice : dÃ©couvrir comment changer de buffer
  - Ã  la souris
  - au clavier
- {{{vocabulaire}}} : minibuffer
- La complÃ©tion avec Tab dans le minibuffer
  - On peut cliquer dedans !

- Plusieurs buffers Ã  l'Ã©cran ? Pas de panique :
  - =C-x o= @@html:<img src="https://upload.wikimedia.org/wikipedia/commons/thumb/7/74/PublicInformationSymbol_EmergencyExit.svg/563px-PublicInformationSymbol_EmergencyExit.svg.png" style="float: right; max-width: 10%;" />@@
  - =C-g= ou =ESC ESC ESC= â†’ Ã€ apprendre par cÅ“ur

*** But secondaire #3.1 : dÃ©placements Ã  l'intÃ©rieur d'un buffer
  - Commandes de mouvement : [[https://www.gnu.org/software/emacs/manual/html_node/emacs/Moving-Point.html][â†’ doc officielle]]
  - Recherche littÃ©rale avant / arriÃ¨re
  - Recherche par expression rÃ©guliÃ¨re avant / arriÃ¨re

** But #4 : premiÃ¨res personnalisations

@@html:<h4>delete-selection-mode</h4>@@

- Ã€ la souris : Options â†’ Customize Emacs â†’ Top-level Customization Group
- Au clavier : =M-x customize-group <RET>=
   - ğŸ’¡ =M-x= == â€œcommand paletteâ€
   - Votre touche mÃ©ta ne marche pas ? Un peu de patience... (Â§ suivant)
     - Utiliser Escape pour l'instant : =Esc x customize-group <RET>=

*** Un buffer n'est pas un fichier !

Dans un buffer =Customize=, on ne peut pas modifier le texte.
- Tout est un buffer â€” Mais tout n'est pas un fichier
- Help â†’ Describe â–¸ ...
  - ... Describe Buffer modes
- Au clavier : C-h â†’ ...
  - ... â†’ C-h
  - C-h m

*** Exercice : ğŸ¤« =C-g= sans la ğŸ””

*** Exercice : ğŸ¤« =C-g= sans la ğŸ””

Solution : =M-x customize-variable <RET> visible-bell=

** But #5 : persistance des personnalisations

Le fameux =.emacs.d/init.el=...

- Sauvegarder le buffer =Customize= ? ğŸ¤”
- Les fichiers =~/.emacs= et =~/.emacs.d/=
- {{{definitionofdone}}} :
  - Emacs redÃ©marre sans signaler d'erreurs
  - Les changements de configuration sont persistants
- Exercice : renommer =~/.emacs=  â†’ @@html:<br/>@@ =~/.emacs.d/init.el=
  - Depuis Emacs bien sÃ»r !

*** But secondaire #5.1 : =column-number-mode=

** But #6 : maÃ®tre des touches

@@html:<h4>... Quelles touches ?</h4>@@

1. Ouvrir votre =~/.emacs.d/init.el=
2. Rappel :
   - Help â†’ Describe â–¸ Describe buffer modes
   - =C-h m=

- {{{vocabulaire}}} : major mode, minor mode(s)
- Exercice : comment faire pour tester mes changements de =.emacs.d/init.el= sans redÃ©marrer Emacs ?
- {{{vocabulaire}}} : =eval=

*** MaÃ®tre des touches : touche Meta

RÃ©fÃ©rence : https://www.emacswiki.org/emacs/MetaKeyProblems
  - Mac: =M-x customize-group <ret> ns=
  - Linux Ubuntu : (?)

*** MaÃ®tre des touches : =C-z= â†’ undo

Notre premier fragment d'Emacs Lisp Â«fait mainÂ» :

#+BEGIN_SRC elisp
(global-set-key [(control z)] 'undo)
#+END_SRC

*** En savoir plus sur Emacs Lisp

- =C-h f= lorsque le curseur est sur une fonction Emacs Lisp pour avoir de l'aide
  - Permet de connaÃ®tre la/les touche(s) qui active cette fonction
- {{{vocabulaire}}} : fonction interactive

*** But secondaire #6.1 : cua-mode, ğŸ‘ğŸ‘ ?
    :PROPERTIES:
    :reveal_background: https://img2.freepng.fr/20180311/odq/kisspng-united-states-easter-bunny-uncle-sam-richard-nixon-oil-painting-grandfather-5aa5363eac5952.823462721520776766706.jpg
    :reveal_background_opacity: 0.3
    :html_container_class: slide-text-white
    :END:

Ã€ vous d'essayer !

** But #7 : un mode majeur - Web-mode

1. Ouvrir un fichier PHP
2. @@html:<img src="./images/emacs-php-tout-nu.png" style="max-height: 40vh; margin: 0;"/>@@
3. â€¦ C'est pas terrible.

*** Paquetages #1 : configuration des dÃ©pÃ´ts
- M-x package-list-packages <RET>
  - Bien... Mais pas top !
    #+BEGIN_SRC elisp
    (add-to-list 'package-archives
      '("melpa" . "https://melpa.org/packages/"))
    #+END_SRC
  - Tiens... Ã‡a plante.
    - Ã€ la ligne d'avant, rajouter
      #+BEGIN_SRC elisp
      (require 'package)
      #+END_SRC

*** Paquetages #2 : installer web-mode
- Exercice : installer Web-mode.
  - Rappel : C-h m pour comprendre dans quel Ã©tat j'erre
- Quand c'est fait : ouvrir ou basculer vers un fichier PHP; M-x web-mode
- ... Mais Ã§a ne Â«tientÂ» pas au redÃ©marrage â˜¹
  - RÃ©solu au Â§ suivant. Suspense...

*** Paquetages #3 : paquetages et configuration

- Pour plusieurs raisons, le systÃ¨me de paquetages n'est pas au cÅ“ur de l'extensibilitÃ© d'Emacs
  - Historique : Emacs date de 1985 (CTAN : 1992, CPAN : 1995)
  - Stallmann : CathÃ©drale vs. bazaar, idÃ©alisme / control freak vs. pragmatisme
- La solution : moar Lisp avec use-package
  - Rajouter (package-initialize) (require 'use-package)
  - Voir aussi https://jwiegley.github.io/use-package/installation/

** But #7 : magit â€” Une premiÃ¨re â€œkiller appâ€ avec Emacs

*** But secondaire #7.1 : =git-gutter=

* Chapitre 2 : efficacitÃ©

** But #1 : framework(s) de complÃ©tion

- L'embarras du choix...
  - company (recommandÃ©)
  - ido
  - auto-complete
  - Old and busted: icicles, icomplete
- Moar completion?
  - Helm
  - yasnippet

* Chapitre 3 : maÃ®trise


** Garder votre =.emacs.d/init.el= lisible

*** DÃ©placer les customizations dans un fichier Ã  part

(require 'custom)
(setq custom-file (concat user-emacs-directory "/emacs-custom.el"))
(when (file-exists-p custom-file) (load-file custom-file))

- Employer Quelpa et use-package
- =add-hook=, 

