<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="utf-8"/>
<title>Emacs en partant de zéro</title>
<meta name="author" content="Dominique Quatravaux"/>
<meta name="description" content=""/>
<meta name="keywords" content=""/>
<style type="text/css">
.underline { text-decoration: underline; }
</style>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/reveal.js@4.3.1/dist/reveal.css"/>

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/reveal.js@4.3.1/dist/theme/moon.css" id="theme"/>


<!-- If the query includes 'print-pdf', include the PDF print sheet -->
<script>
    if( window.location.search.match( /print-pdf/gi ) ) {
        var link = document.createElement( 'link' );
        link.rel = 'stylesheet';
        link.type = 'text/css';
        link.href = 'https://cdn.jsdelivr.net/npm/reveal.js@4.3.1/css/print/pdf.css';
        document.getElementsByTagName( 'head' )[0].appendChild( link );
    }
</script>
<style type="text/css">
.reveal ul { display: inherit; }
section.slide-text-white { color: white; }
p.small { font-size: 0.6em; text-align: justify; }
code {  color: lightblue; }
</style>
</head>
<body>
<div class="reveal">
<div class="slides">
<section id="sec-title-slide" data-background="https://media.mehrnews.com/d/2019/07/21/4/3185382.jpg" data-background-opacity="0.3"><h1 class="title">Emacs en partant de zéro</h1><p class="subtitle"><a href="https://go.epfl.ch/emacsdezero">https://go.epfl.ch/emacsdezero</a></p>
<h2 class="author">Dominique Quatravaux</h2><h2 class="date">14.06.2022</h2>
</section>
<section id="sec-table-of-contents"><div id="table-of-contents" role="doc-toc">
<h2>Table des matières</h2>
<div id="text-table-of-contents" role="doc-toc">
<ul>
<li><a href="#/slide-org76c237b">Chapitre 1 : autonomie</a></li>
<li><a href="#/slide-orgcecfafb">Chapitre 2 : efficacité</a></li>
<li><a href="#/slide-orgbb83377">Chapitre 3 : maîtrise</a></li>
</ul>
</div>
</div>
</section>

<section>
<section id="slide-org76c237b">
<h2 id="org76c237b">Chapitre 1 : autonomie</h2>
<div class="outline-text-2" id="text-org76c237b">
</div>
</section>
</section>
<section>
<section id="slide-org70865ab" class="slide-text-white" data-background="https://img.static-rmg.be/a/view/q75/w962/h503/4264804/4c49c975418611b921b55576f621e8ae-jpg.jpg" data-background-opacity="0.4">
<h3 id="org70865ab">Philosophie / orientation</h3>
<ul>
<li>Ne pas s'attendre à ce que ça Juste Marche™ ! #desfoisoui #desfoisnon</li>
<li>Un écosystème proliférant — Pas facile de faire les bons choix</li>
<li>Même choisir une direction pour avancer peut faire l'objet d'un <a href="https://github.com/redguardtoo/mastering-emacs-in-one-year-guide">tuto</a> !
<ul>
<li>💁 S'astreindre à une <b>🎯 <i>Definition of done</i></b></li>
<li>Concrètement : un jeu de tests manuel (rédigé et observé)</li>

</ul></li>

</ul>

</section>
</section>
<section>
<section id="slide-org2cab760">
<h3 id="org2cab760">But #1 : installation</h3>
<ul>
<li>Pour le présent dojo : version minimale = Emacs 26 (celui d'Ubuntu Focal), mais plus récent ≡ mieux</li>

</ul>

<p>
<p class="small"><span style="display: inline; vertical-align: 0%; font-size: 2em">💡🥱</span>
Si vous vous ennuyez : cliquez sur <span style="font: 3em bold; display: inline-block; color: var(--r-link-color);">˅</span> en bas à droite&#x2026;
</p>
</p>

</section>
<section id="slide-orga4c0f62" class="slide-text-white" data-background="https://w0.peakpx.com/wallpaper/178/808/HD-wallpaper-heavenly-trumpets-statues-music-trumpet-heaven-celestial-angels.jpg" data-background-opacity="0.3">
<h4 id="orga4c0f62">À propos de cette présentation</h4>
<ul>
<li>Écrite avec Emacs</li>
<li>Un seul <a href="https://github.com/domq/domq.github.io/blob/main/20220614-emacs.org">fichier source</a> (+ les images)</li>
<li>🔋 Grâce à <a href="https://orgmode.org/">🦄 org-mode</a> + <a href="https://github.com/hexmode/ox-reveal">org-reveal</a></li>

</ul>

<p>
<p class="small"><span style="display: inline; vertical-align: 0%; font-size: 2em">↕️</span>
Comme dans toute présentation <a href="https://revealjs.com/">reveal.js</a>, la flèche vers le bas <span style="font: 3em bold; display: inline-block; color: var(--r-link-color);">˅</span> permet de naviguer vers des informations supplémentaires, que le présentateur «sautera» peut-être faute de temps.
</p>
</p>

</section>
<section id="slide-org1be756b" class="slide-text-white" data-background="https://upload.wikimedia.org/wikipedia/commons/thumb/0/0b/BhfEpfenhofen_Ausfahrsignale_Talaufwaerts_II.JPG/1200px-BhfEpfenhofen_Ausfahrsignale_Talaufwaerts_II.JPG" data-background-opacity="0.3">
<h4 id="org1be756b">Balises</h4>
<dl>
<dt><b>📚 Vocabulaire</b></dt><dd>Cette annotation repère les mots et concepts qu'utilise Emacs dans un sens bien à lui (privilège de l'âge&#x2026;)</dd>
<dt><b>🎯 <i>Definition of done</i></b></dt><dd>Cette annotation suggère un nouveau point d'attention dans votre <i>definition of done</i> ou contrôle-qualité de votre configuration Emacs. Considérez que vous venez de gagner un level lorsque vous la rencontrez 😉</dd>

</dl>

</section>
</section>
<section>
<section id="slide-org8b04549">
<h3 id="org8b04549">But #2 : éditer un fichier</h3>
<ul>
<li>Ouvrir un fichier
<ul>
<li>À la souris, via les menus</li>
<li>Au clavier
<ul>
<li>💡 Les menus montrent les raccourcis clavier !</li>
<li>Suivez le guide : <a href="https://www.gnu.org/software/emacs/refcards/pdf/refcard.pdf">GNU Emacs Reference Card</a></li>

</ul></li>

</ul></li>
<li>Visualiser l'état sauvegardé ou non
<ul>
<li><b>📚 Vocabulaire</b> : modeline</li>

</ul></li>
<li>Sauvegarder</li>

</ul>

</section>
</section>
<section>
<section id="slide-org895f1c1">
<h3 id="org895f1c1">But #3 : plusieurs fichiers à la fois</h3>
<ul>
<li><b>📚 Vocabulaire</b> : buffer</li>
<li>Exercice : découvrir comment changer de buffer
<ul>
<li>à la souris</li>
<li>au clavier</li>

</ul></li>
<li><b>📚 Vocabulaire</b> : minibuffer</li>
<li>La complétion avec Tab dans le minibuffer
<ul>
<li>On peut cliquer dedans !</li>

</ul></li>

<li>Plusieurs buffers à l'écran ? Pas de panique :
<ul>
<li><code>C-x o</code> <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/7/74/PublicInformationSymbol_EmergencyExit.svg/563px-PublicInformationSymbol_EmergencyExit.svg.png" style="float: right; max-height: 10vh;" /></li>
<li><code>C-g</code> ou <code>ESC ESC ESC</code> → À apprendre par cœur</li>

</ul></li>

</ul>

</section>
<section id="slide-org4b648aa">
<h4 id="org4b648aa">But secondaire #3.1 : déplacements à l'intérieur d'un buffer</h4>
<ul>
<li>Commandes de mouvement : <a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Moving-Point.html">→ doc officielle</a></li>
<li>Recherche littérale avant / arrière</li>
<li>Recherche par expression régulière avant / arrière</li>

</ul>

</section>
</section>
<section>
<section id="slide-orgd2a79f7">
<h3 id="orgd2a79f7">But #4 : premières personnalisations</h3>
<ul>
<li>À la souris : Options → Customize Emacs → Top-level Customization Group</li>
<li>Au clavier : <code>M-x customize &lt;RET&gt;</code>
<ul>
<li>💡 <code>M-x</code> == “command palette”</li>
<li>Votre touche méta ne marche pas ? Un peu de patience&#x2026; (§ suivant)
<ul>
<li>Utiliser Escape pour l'instant : <code>Esc x customize &lt;RET&gt;</code></li>

</ul></li>

</ul></li>

</ul>

</section>
<section id="slide-org2350567">
<h4 id="org2350567">Un buffer n'est pas un fichier !</h4>
<p>
Dans un buffer <code>*Customize*</code>, on ne peut pas modifier le texte.
</p>

<p>
💡 Les buffers qui n'ont pas de fichier ont typiquement un nom qui commence et finit par <code>*</code>.
</p>

<p>
Que faire alors ?
</p>
<ul>
<li>Help → Describe ▸ &#x2026;
<ul>
<li>&#x2026; Describe Buffer modes</li>

</ul></li>
<li>Au clavier : C-h → &#x2026;
<ul>
<li>&#x2026; → C-h</li>
<li>C-h m</li>

</ul></li>

</ul>

</section>
<section id="slide-org72925e0">
<h4 id="org72925e0">Exercice : customiser <code>delete-selection-mode</code></h4>
<p>
Validation :
</p>
<ol>
<li>Ouvrir un fichier dans un buffer</li>
<li>Sélectionner du texte</li>
<li>Appuyer sur une lettre</li>

</ol>

<p>
Résultat attendu : la sélection <b>s'efface</b> et est remplacée par la lettre saisie.
</p>

</section>
<section id="slide-org33a0f84">
<h4 id="org33a0f84">Exercice : 🤫 <code>C-g</code> sans la 🔔</h4>

</section>
<section id="slide-orgbc906a3">
<h4 id="orgbc906a3">Exercice : 🤫 <code>C-g</code> sans la 🔔</h4>
<p>
Solution : <code>M-x customize-variable &lt;RET&gt; visible-bell</code>
</p>

</section>
</section>
<section>
<section id="slide-org518f205">
<h3 id="org518f205">But #5 : persistance des personnalisations</h3>
<p>
Le fameux <code>.emacs.d/init.el</code>&#x2026;
</p>

<ul>
<li>Sauvegarder un buffer <code>*Customize*</code> ? 🤔</li>
<li>Les fichiers <code>~/.emacs</code> et <code>~/.emacs.d/</code></li>
<li><b>🎯 <i>Definition of done</i></b> :
<ul>
<li>Emacs redémarre sans signaler d'erreurs</li>
<li>Les changements de configuration sont persistants</li>

</ul></li>
<li>Exercice : renommer <code>~/.emacs</code>  → <br/> <code>~/.emacs.d/init.el</code>
<ul>
<li>Depuis Emacs bien sûr !</li>

</ul></li>

</ul>

</section>
</section>
<section>
<section id="slide-orgddf1ec6">
<h3 id="orgddf1ec6">But #6 : maître des touches</h3>
<p>
<h4>... Quelles touches ?</h4>
</p>

<ol>
<li>Ouvrir votre <code>~/.emacs.d/init.el</code></li>
<li>Rappel :
<ul>
<li>Help → Describe ▸ Describe buffer modes</li>
<li><code>C-h m</code></li>

</ul></li>

<li><b>📚 Vocabulaire</b> : major mode, minor mode(s)</li>
<li>Exercice : comment faire pour tester mes changements de <code>.emacs.d/init.el</code> sans redémarrer Emacs ?</li>
<li><b>📚 Vocabulaire</b> : <code>eval</code></li>

</ol>

</section>
<section id="slide-org0bc94a2">
<h4 id="org0bc94a2">Maître des touches : touche Meta</h4>
<p>
Référence : <a href="https://www.emacswiki.org/emacs/MetaKeyProblems">https://www.emacswiki.org/emacs/MetaKeyProblems</a>
</p>
<ul>
<li>Mac: <code>M-x customize-group &lt;ret&gt; ns</code></li>
<li>Linux Ubuntu : (?)</li>

</ul>

</section>
<section id="slide-org44064ea">
<h4 id="org44064ea">Maître des touches : <code>C-z</code> → undo</h4>
<p>
Notre premier fragment d'Emacs Lisp «fait main» :
</p>

<div class="org-src-container">

<pre  class="src src-elisp"   ><code trim>(global-set-key [(control z)] 'undo)
</code></pre>
</div>

</section>
<section id="slide-org16660c1">
<h4 id="org16660c1">En savoir plus sur Emacs Lisp</h4>
<ul>
<li><code>C-h f</code> lorsque le curseur est sur une fonction Emacs Lisp pour avoir de l'aide
<ul>
<li>Permet de connaître la/les touche(s) qui active(nt) cette fonction</li>

</ul></li>
<li><b>📚 Vocabulaire</b> : fonction interactive</li>

</ul>

</section>
<section id="slide-orgdf44a81" class="slide-text-white" data-background="https://img2.freepng.fr/20180311/odq/kisspng-united-states-easter-bunny-uncle-sam-richard-nixon-oil-painting-grandfather-5aa5363eac5952.823462721520776766706.jpg" data-background-opacity="0.3">
<h4 id="orgdf44a81">But secondaire #6.1 : cua-mode, 👍👎 ?</h4>
<p>
À vous d'essayer !
</p>

</section>
</section>
<section>
<section id="slide-orgc732fde">
<h3 id="orgc732fde">But #7 : un mode majeur - Web-mode</h3>
<ol>
<li>Ouvrir un fichier PHP</li>
<li><img src="./images/emacs-php-tout-nu.png" style="max-height: 40vh; margin: 0;"/></li>
<li>… C'est pas terrible.</li>

</ol>

</section>
<section id="slide-org5b7555e">
<h4 id="org5b7555e">Configuration des dépôts</h4>
<ul>
<li><code>M-x package-list-packages &lt;RET&gt;</code>
<ul>
<li><p>
Bien&#x2026; Mais pas top !
</p>
<div class="org-src-container">

<pre  class="src src-elisp"   ><code trim>(add-to-list 'package-archives
  '("melpa" . "https://melpa.org/packages/"))
</code></pre>
</div></li>
<li>Tiens&#x2026; Ça plante.
<ul>
<li>💡 La variable <code>package-archives</code> est modifiée avant d'être définie.</li>
<li><p>
🛠️ Insérer à la ligne précédente
</p>
<div class="org-src-container">

<pre  class="src src-elisp"   ><code trim>(require 'package)
</code></pre>
</div></li>

</ul></li>

</ul></li>

</ul>

</section>
<section id="slide-orgf1ac408">
<h4 id="orgf1ac408">Exercice : installer web-mode</h4>
<ul>
<li>Rappel : depuis le buffer <code>*Packages*</code>, <code>C-h m</code> pour comprendre dans quel état j'erre</li>
<li>Quand c'est fait :  <img src="./images/emacs-php-web-mode.png" style="float: right; max-width: 40vh;" />
<ol>
<li>ouvrir ou basculer vers un fichier PHP</li>
<li><code>M-x web-mode</code></li>
<li>… Profit!</li>

</ol></li>
<li>&#x2026; Mais ça ne «tient» pas au redémarrage ☹ À suivre&#x2026;</li>

</ul>

</section>
<section id="slide-orge5bde93">
<h4 id="orge5bde93">🤦 Pourquoi ?&#x2026; 🤦</h4>
<p>
Pour plusieurs raisons, le système de paquetages n'est pas au cœur de l'extensibilité d'Emacs
</p>
<ul>
<li>Historique : Emacs date de 1985 (CTAN : 1992, CPAN : 1995)</li>
<li>Stallmann : Cathédrale vs. bazaar, idéalisme / control freak vs. pragmatisme</li>

</ul>

</section>
<section id="slide-org3530f3f">
<h4 id="org3530f3f">La solution</h4>
<ol>
<li>Installer <a href="https://jwiegley.github.io/use-package/installation/">use-package</a> (cf. supra)</li>
<li><div class="org-src-container">

<pre  class="src src-elisp"   ><code trim>(package-initialize)
(require 'use-package)

(use-package web-mode
  :mode "\\(html?\\|php\\)$")
</code></pre>
</div></li>

</ol>

</section>
<section id="slide-orge98fb4e">
<h4 id="orge98fb4e">La solution de la solution</h4>
<p>
<img src="./images/regexp-builder.gif" style="max-height: 40vh; float: right;"/>
<h4> <code>M-x regexp-builder</code> </h4>
<div style="clear: both;"></div>
</p>

<p>
… et/ou RTFM :
</p>

<ul>
<li><code>M-x info</code> → <code>g (emacs) &lt;RET&gt;</code></li>
<li>Cliquer sur <code>Regexps</code></li>

</ul>


</section>
</section>
<section>
<section id="slide-org06e9e03">
<h3 id="org06e9e03">But #8 : magit — Une première “killer app” avec Emacs</h3>
<ul>
<li>Installer Magit</li>
<li>Configurer la combinaison de touches <code>C-x v b</code> pour qu'elle lance la commande <code>magit-status</code></li>

</ul>

</section>
<section id="slide-org4f162c4" class="slide-text-white" data-background="https://surrey-content.surrey.ac.uk/sites/default/files/styles/hero_large/public/2019-01/exams-on-the-day.jpg" data-background-opacity="0.3">
<h4 id="org4f162c4">… À vous de jouer !</h4>

</section>
<section id="slide-org3e7c274">
<h4 id="org3e7c274">Solution</h4>
<p>
Toujours avec <a href="https://jwiegley.github.io/use-package/installation/">use-package</a>:
</p>

<p>
(use-package magit
  :bind ([(control x) (v) (b)] . magit-status))
</p>

<p>
<b>🎯 <i>Definition of done</i></b> : pour de meilleures performances, les paquetages «lourds» comme Magit, ne doivent <b>pas</b> se charger au démarrage d'Emacs.
</p>
<ul>
<li>Contrôle avec <code>C-h v features &lt;RET&gt;</code> : cette variable ne doit pas contenir <code>magit</code></li>

</ul>

</section>
</section>
<section>
<section id="slide-orgb78ff67" class="slide-text-white" data-background="https://media1.popsugar-assets.com/files/thumbor/i651KmqcSTzTxBIoBQvBQitLHzo/fit-in/2048xorig/filters:format_auto-!!-:strip_icc-!!-/2021/03/18/976/n/24155406/tmp_UTsZdZ_beeeb1a5e62e84ed_GettyImages-1208799380.jpg" data-background-opacity="0.3">
<h3 id="orgb78ff67">Je sais faire tout seul ! 1/5</h3>
<p>
En modifiant mon <code>~/.emacs.d/init.el</code>:
</p>

<ul>
<li>Je fais marcher les touches <code>Home</code>, <code>End</code>, <code>C-Home</code> et <code>C-End</code> (ou équivalent de mon choix sur Mac)
<ul>
<li>Commandes respectives : <code>beginning-of-line</code>, <code>end-of-line</code>, <code>beginning-of-buffer</code> et <code>end-of-buffer</code></li>

</ul></li>
<li>Je désactive les commandes clavier que je n'aime pas avec la fonction <code>global-unset-key</code></li>
<li><code>(tool-bar-mode -1)</code> : si je n'aime pas les icônes</li>

</ul>

</section>
<section id="slide-org3c47cc9">
<h4 id="org3c47cc9">Je sais faire tout seul ! 2/5</h4>
<p>
Avec l'aide de Google, je choisis, j'installe et je configure ce qui me plaît parmi :
</p>

<ul>
<li>les modes adaptés à mes langages de programmation préférés</li>
<li><code>column-number-mode</code> : fait apparaître le numéro de la colonne dans la <i>modeline</i> à côté du numéro de ligne.</li>
<li><code>git-gutter</code> : les lignes modifiées d'un fichier qui est sous Git sont marquées dans la marge</li>
<li><code>undo-tree</code> : je voyage dans les lignes temporelles de mon travail d'édition</li>

</ul>


</section>
<section id="slide-orgfc044c5">
<h4 id="orgfc044c5">Je sais faire tout seul ! 3/5</h4>
<p>
J'évalue, configure et choisis un ou des frameworks de complétion :
</p>
<ul>
<li>company (recommandé)</li>
<li>ido</li>
<li>auto-complete</li>
<li>(Old and busted: icicles, icomplete)</li>

</ul>
<ul>
<li>Moar completion?
<ul>
<li>Helm</li>
<li>yasnippet</li>

</ul></li>

</ul>

</section>
<section id="slide-orgeed5c15">
<h4 id="orgeed5c15">Je sais faire tout seul ! 4/5</h4>
<p>
Je consacre du temps pour maîtriser les “power features” d'Emacs 💪 :
</p>

<ul>
<li><code>org-mode</code> : ma vie en texte plat</li>
<li><code>tramp</code> : j'accède à des fichiers distants en ouvrant <code>/ssh:remote-host:/var/www/vhosts/tototutu.php</code>
<ul>
<li>&#x2026; Et je fais marcher Magit à distance ! #emacsenprod</li>

</ul></li>

</ul>

</section>
<section id="slide-orgdb3484f" class="slide-text-white" data-background="https://rnli.org/-/media/rnli/images/safety/42064-yacht-sailing-view-from-onboard-boat-nathan-williams-16x9.jpg?rev=7332374b69104667a73f3429c0cf6e36&amp;w=1500&amp;h=844&amp;hash=EE495B44B8DE34A21B23A0ED76BEB06D" data-background-opacity="0.3">
<h4 id="orgdb3484f">Je sais faire tout seul ! 5/5</h4>
<ul>
<li>Je lis une fois en entier la page d'Info (<code>M-x info</code>) d'Emacs
<ul>
<li>💡 <code>M-x widen</code> pour tout voir d'un seul coup (sans navigation) !</li>

</ul></li>
<li>Je me crée un compte sur l'<a href="https://www.emacswiki.org/">EmacsWiki</a></li>
<li>Je m'abonne à <a href="https://www.reddit.com/r/emacs/">/r/emacs</a></li>

</ul>

</section>
</section>
<section>
<section id="slide-orgcecfafb">
<h2 id="orgcecfafb">Chapitre 2 : efficacité</h2>
<div class="outline-text-2" id="text-orgcecfafb">
</div>
</section>
</section>
<section>
<section id="slide-orgbec98f2">
<h3 id="orgbec98f2">But #1 : framework(s) de complétion</h3>
<ul>
<li>L'embarras du choix&#x2026;</li>

</ul>

</section>
</section>
<section>
<section id="slide-orgbb83377">
<h2 id="orgbb83377">Chapitre 3 : maîtrise</h2>
<div class="outline-text-2" id="text-orgbb83377">
</div>
</section>
</section>
<section>
<section id="slide-org16f5908">
<h3 id="org16f5908">Garder votre <code>.emacs.d/init.el</code> lisible</h3>
<div class="outline-text-3" id="text-org16f5908">
</div>
</section>
<section id="slide-org32adba5">
<h4 id="org32adba5">Déplacer les customizations dans un fichier à part</h4>
<p>
(require 'custom)
(setq custom-file (concat user-emacs-directory "/emacs-custom.el"))
(when (file-exists-p custom-file) (load-file custom-file))
</p>

<ul>
<li>Employer Quelpa et use-package</li>
<li><code>add-hook</code>,</li>

</ul>
</section>
</section>
</div>
</div>
<script src="https://cdn.jsdelivr.net/npm/reveal.js@4.3.1/dist/reveal.js"></script>

<script>
// Full list of configuration options available here:
// https://github.com/hakimel/reveal.js#configuration
Reveal.initialize({

// Optional libraries used to extend on reveal.js
dependencies: [
 { src: 'https://cdn.jsdelivr.net/npm/reveal.js@4.3.1/plugin/markdown/marked.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
 { src: 'https://cdn.jsdelivr.net/npm/reveal.js@4.3.1/plugin/markdown/markdown.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
 { src: 'https://cdn.jsdelivr.net/npm/reveal.js@4.3.1/plugin/zoom-js/zoom.js', async: true, condition: function() { return !!document.body.classList; } },
 { src: 'https://cdn.jsdelivr.net/npm/reveal.js@4.3.1/plugin/notes/notes.js', async: true, condition: function() { return !!document.body.classList; } }]

});

</script>
</body>
</html>
